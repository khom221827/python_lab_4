import csv
import random
from faker import Faker

class EmployeeGenerator:
    def __init__(self):
        self.fake = Faker('uk_UA')
        self.ukrainian_middle_names = [
            'Антонович', 'Михайлович', 'Григоріївна', 'Леонідович', 'Володимирівна', 'Русланович',
            'Федорович', 'Натанович', 'Кирилівна', 'Захарович', 'Ярославівна', 'Мстиславович',
            'Лідійовна', 'Даніїлівна', 'Всеволодівна', 'Антінович', 'Валентинівна', 'Ростиславівна',
            'Юрійович', 'Валеріївна', 'Федосіївна', 'Єфремівна', 'Борисович', 'Марківна', 'Євстахіївна',
            'Васильович', 'Олексіївна', 'Савеліївна', 'Мар’янович', 'Євгенович', 'Зеновіївна',
            'Всеславівна', 'Олесьович', 'Андронікович', 'Миронівна', 'Святославівна', 'Давидович',
            'Мстиславівна', 'Захарівна', 'Олексійович', 'Григоріївич', 'Сергійович', 'Левівна',
            'Макарович', 'Дмитрович', 'Феофанівна', 'Семенівна', 'Єфросинівна', 'Костянтинівна',
            'Гаврилівна', 'Дорофіївна', 'Андриянівна', 'Вікторівич', 'Соломонівна', 'Варфоломійович',
            'Несторович', 'Вадимівна', 'Афанасіївна', 'Мар’янівна', 'Анікітівна', 'Семіонівна',
            'Симонівна', 'Гордіївна', 'Спартаківна', 'Артемівна', 'Тимофіївна', 'Іларіонівна',
            'Аркадіївна', 'Андронімівна', 'Антігонівна', 'Іоаннівна', 'Ізмаїлівна', 'Казимирівна',
            'Ісааківна', 'Герасимівна', 'Даніїлівна', 'Альбертівна', 'Болеславівна', 'Амвросіївна',
            'Анісіївна', 'Вітольдівна', 'Володиславівна', 'Юхимівна', 'Климентівна', 'Корнеліївна',
            'Юстиніанівна', 'Агапіївна', 'Глібівна', 'Горгоніївна', 'Зосимівна', 'Маркелівна',
            'Мартінівна', 'Мелентіївна', 'Назаріївна', 'Никифорівна', 'Феодорівна', 'Філаретівна',
            'Іпатіївна', 'Іракліївна', 'Лаврентіївна', 'Лаврінівна', 'Мінаївна', 'Мірілівна',
            'Силуанівна', 'Тихонівна', 'Трифонівна', 'Філімонівна', 'Юліанівна', 'Юріївна',
            'Юхиміанівна', 'Юхимович', 'Юхимівна'
        ]

    def generate_employee(self, index):
        gender = 'Жінка' if index % 10 < 4 else 'Чоловік'
        birthdate = self.fake.date_of_birth(minimum_age=16, maximum_age=72)

        if gender == 'Жінка':
            full_name = self.fake.first_name_female(), self.fake.last_name_female()
        else:
            full_name = self.fake.first_name_male(), self.fake.last_name_male()

        middle_name = random.choice(self.ukrainian_middle_names)

        return {
            'Прізвище': full_name[1],
            'Ім’я': full_name[0],
            'По батькові': middle_name,
            'Стать': gender,
            'Дата народження': birthdate.strftime('%Y.%m.%d'),
            'Посада': self.fake.job(),
            'Місто проживання': self.fake.city(),
            'Адреса проживання': self.fake.address(),
            'Телефон': self.fake.phone_number(),
            'Email': self.fake.email()
        }

    def save_to_csv(self, filename='employees.csv', num_employees=2300):
        with open(filename, 'w', newline='', encoding='utf-8') as csvfile:
            fieldnames = ['Прізвище', 'Ім’я', 'По батькові', 'Стать', 'Дата народження', 'Посада',
                          'Місто проживання', 'Адреса проживання', 'Телефон', 'Email']
            writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
            writer.writeheader()

            for i in range(1, num_employees + 1):
                employee_data = self.generate_employee(i)
                writer.writerow(employee_data)

        print(f"Готово! Таблиця була збережена у файлі '{filename}' з кодировкою UTF-8 і номерами рядків.")

def main():
    generator = EmployeeGenerator()
    generator.save_to_csv()

if __name__ == "__main__":
    main()
